{"name": "test_search_character_with_yaml[\\u968f\\u4fbf\\u4e71\\u8f93 - \\u5e94\\u8be5\\u672a\\u627e\\u5230]", "status": "failed", "statusDetails": {"message": "AssertionError: assert 200 == 404\n +  where 200 = <Response [200 OK]>.status_code", "trace": "monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x10687f640>, test_client = <starlette.testclient.TestClient object at 0x1066c75b0>\ncase = {'expect_status': 404, 'name': '随便乱输 - 应该未找到', 'query': 'this-name-should-not-exist-xyz123'}\n\n    @allure.feature(\"character search\")\n    @allure.story(\"search with yaml cases\")\n    @pytest.mark.parametrize(\"case\", SEARCH_CASES, ids=SEARCH_CASE_IDS)\n    def test_search_character_with_yaml(monkeypatch, test_client, case):\n        \"\"\"\n        使用 YAML 数据驱动测试 /api/character/search\n    \n        - 对于非空名字，我们用 fake_search 把外部 AniList API Mock 掉，避免真实网络请求\n        - 对于空字符串 / 只空格，接口本身会直接返回 400\n        \"\"\"\n        query = case[\"query\"]\n    \n        # 如果 query 非空，则 mock 掉 search_characters_from_anilist，返回固定数据\n        if query.strip():\n            def fake_search(name: str, per_page: int = 5) -> List[dict]:\n                return [\n                    {\n                        \"id\": 1,\n                        \"name\": {\n                            \"full\": \"Naruto Uzumaki\",\n                            \"native\": \"うずまき ナルト\",\n                            \"alternative\": [],\n                        },\n                        \"image\": {\"large\": \"large.jpg\", \"medium\": \"medium.jpg\"},\n                        \"description\": \"Ninja\",\n                        \"gender\": \"Male\",\n                        \"age\": \"17\",\n                        \"dateOfBirth\": {\"year\": 1990, \"month\": 10, \"day\": 10},\n                        \"bloodType\": \"O\",\n                        \"favourites\": 100,\n                        \"siteUrl\": \"https://example.com\",\n                        \"media\": {\"edges\": []},\n                    }\n                ]\n    \n            monkeypatch.setattr(main, \"search_characters_from_anilist\", fake_search)\n    \n        # 1. 发请求\n        resp = test_client.get(\"/api/character/search\", params={\"name\": query})\n    \n        # 2. 断言 HTTP 状态码\n>       assert resp.status_code == case[\"expect_status\"]\nE       assert 200 == 404\nE        +  where 200 = <Response [200 OK]>.status_code\n\ntests/test_api_2.py:188: AssertionError"}, "description": "\n    使用 YAML 数据驱动测试 /api/character/search\n\n    - 对于非空名字，我们用 fake_search 把外部 AniList API Mock 掉，避免真实网络请求\n    - 对于空字符串 / 只空格，接口本身会直接返回 400\n    ", "parameters": [{"name": "case", "value": "{'name': '随便乱输 - 应该未找到', 'query': 'this-name-should-not-exist-xyz123', 'expect_status': 404}"}], "start": 1764142445675, "stop": 1764142445675, "uuid": "3b7d8458-30d4-41e5-a37b-8025bcc0826c", "historyId": "d14c91fa057ef4ab5e34e428b1348c58", "testCaseId": "155e2863528281858ff72a69010e0495", "fullName": "tests.test_api_2#test_search_character_with_yaml", "labels": [{"name": "story", "value": "search with yaml cases"}, {"name": "feature", "value": "character search"}, {"name": "parentSuite", "value": "tests"}, {"name": "suite", "value": "test_api_2"}, {"name": "host", "value": "KdeMacBook-Air.local"}, {"name": "thread", "value": "5488-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.test_api_2"}], "titlePath": ["tests", "test_api_2.py"]}